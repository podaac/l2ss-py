

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reference Guide for l2ss-py &mdash; l2ss-py 3.1.0a2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=4e822480"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Subset Module" href="subset.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            l2ss-py
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="subset.html">Subset Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="subset_harmony.html">Subset Harmony Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_subsetter.html">Run Subsetter Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">l2ss-py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Reference Guide for l2ss-py</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reference-guide-for-l2ss-py">
<h1>Reference Guide for l2ss-py<a class="headerlink" href="#reference-guide-for-l2ss-py" title="Link to this heading"></a></h1>
<section id="l2ss-py">
<h2>l2ss-py<a class="headerlink" href="#l2ss-py" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://sonarcloud.io/dashboard?id=podaac_l2ss-py"><img alt="Coverage" src="https://sonarcloud.io/api/project_badges/measure?project=podaac_l2ss-py&amp;metric=coverage" /></a>
develop: <a class="reference external" href="https://github.com/podaac/l2ss-py/actions/workflows/build-pipeline.yml"><img alt="Develop Build" src="https://github.com/podaac/l2ss-py/actions/workflows/build-pipeline.yml/badge.svg?branch=develop&amp;event=push" /></a>
main: <a class="reference external" href="https://github.com/podaac/l2ss-py/actions/workflows/build-pipeline.yml"><img alt="Main Build" src="https://github.com/podaac/l2ss-py/actions/workflows/build-pipeline.yml/badge.svg?branch=main&amp;event=push" /></a></p>
<p>Harmony service for subsetting L2 data. l2ss-py supports:</p>
<ul class="simple">
<li><p>Spatial subsetting</p>
<ul>
<li><p>Bounding box</p></li>
<li><p>Shapefile subsetting</p></li>
<li><p>GeoJSON subsetting</p></li>
</ul>
</li>
<li><p>Temporal subsetting</p></li>
<li><p>Variable subsetting</p></li>
</ul>
<p>If you would like to contribute to l2ss-py, refer to the <a class="reference internal" href="#CONTRIBUTING.md"><span class="xref myst">contribution document</span></a>.</p>
<section id="initial-setup-with-poetry">
<h3>Initial setup, with poetry<a class="headerlink" href="#initial-setup-with-poetry" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Follow the instructions for installing <code class="docutils literal notranslate"><span class="pre">poetry</span></code> <a class="reference external" href="https://python-poetry.org/docs/">here</a>.</p></li>
<li><p>Install l2ss-py, with its dependencies, by running the following from the repository directory:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">poetry</span> <span class="n">install</span>
</pre></div>
</div>
<p><em><strong>Note:</strong></em> l2ss-py can be installed as above and run without any dependency on <code class="docutils literal notranslate"><span class="pre">harmony</span></code>.
However, to additionally test the harmony adapter layer,
extra dependencies can be installed with <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">install</span> <span class="pre">-E</span> <span class="pre">harmony</span></code>.</p>
</section>
<section id="how-to-test-l2ss-py-locally">
<h3>How to test l2ss-py locally<a class="headerlink" href="#how-to-test-l2ss-py-locally" title="Link to this heading"></a></h3>
<section id="unit-tests">
<h4>Unit tests<a class="headerlink" href="#unit-tests" title="Link to this heading"></a></h4>
<p>There are comprehensive unit tests for l2ss-py. The tests can be run as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">poetry</span> <span class="n">run</span> <span class="n">pytest</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;not aws and not integration&quot;</span> <span class="n">tests</span><span class="o">/</span>
</pre></div>
</div>
<p>You can generate coverage reports as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">poetry</span> <span class="n">run</span> <span class="n">pytest</span> <span class="o">--</span><span class="n">junitxml</span><span class="o">=</span><span class="n">build</span><span class="o">/</span><span class="n">reports</span><span class="o">/</span><span class="n">pytest</span><span class="o">.</span><span class="n">xml</span> <span class="o">--</span><span class="n">cov</span><span class="o">=</span><span class="n">podaac</span><span class="o">/</span> <span class="o">--</span><span class="n">cov</span><span class="o">-</span><span class="n">report</span><span class="o">=</span><span class="n">html</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;not aws and not integration&quot;</span> <span class="n">tests</span><span class="o">/</span>
</pre></div>
</div>
<p><em><strong>Note:</strong></em> The majority of the tests execute core functionality of l2ss-py without ever interacting with the harmony python modules.
The <code class="docutils literal notranslate"><span class="pre">test_subset_harmony</span></code> tests, however, are explicitly for testing the harmony adapter layer
and do require the harmony optional dependencies be installed,
as described above with the <code class="docutils literal notranslate"><span class="pre">-E</span> <span class="pre">harmony</span></code> argument.</p>
</section>
<section id="l2ss-py-script">
<h4>l2ss-py script<a class="headerlink" href="#l2ss-py-script" title="Link to this heading"></a></h4>
<p>You can run l2ss-py on a single granule without using Harmony. In order
to run this, the l2ss-py package must be installed in your current
Python interpreter</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ l2ss-py --help
usage: run_subsetter.py [-h] [--bbox BBOX BBOX BBOX BBOX]
                        [--variables VARIABLES [VARIABLES ...]]
                        [--min-time MIN_TIME] [--max-time MAX_TIME] [--cut]
                        input_file output_file

Run l2ss-py

positional arguments:
  input_file            File to subset
  output_file           Output file

optional arguments:
  -h, --help            show this help message and exit
  --bbox BBOX BBOX BBOX BBOX
                        Bounding box in the form min_lon min_lat max_lon
                        max_lat
  --variables VARIABLES [VARIABLES ...]
                        Variables, only include if variable subset is desired.
                        Should be a space separated list of variable names
                        e.g. sst wind_dir sst_error ...
  --min-time MIN_TIME   Min time. Should be ISO-8601 format. Only include if
                        temporal subset is desired.
  --max-time MAX_TIME   Max time. Should be ISO-8601 format. Only include if
                        temporal subset is desired.
  --cut                 If provided, scanline will be cut
  --shapefile SHAPEFILE
                        Path to either shapefile or geojson file used to subset the provided input granule
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">l2ss</span><span class="o">-</span><span class="n">py</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="nb">input</span><span class="o">.</span><span class="n">nc</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">output</span><span class="o">.</span><span class="n">nc</span> <span class="o">--</span><span class="n">bbox</span> <span class="o">-</span><span class="mi">50</span> <span class="o">-</span><span class="mi">10</span> <span class="mi">50</span> <span class="mi">10</span> <span class="o">--</span><span class="n">variables</span> <span class="n">wind_speed</span> <span class="n">wind_dir</span> <span class="n">ice_age</span> <span class="n">time</span> <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">time</span> <span class="s1">&#39;2015-07-02T09:00:00&#39;</span> <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">time</span> <span class="s1">&#39;2015-07-02T10:00:00&#39;</span> <span class="o">--</span><span class="n">cut</span>
</pre></div>
</div>
<p>An addition to providing a bounding box, spatial subsetting can be achieved by passing in a shapefile or a geojson file.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>run<span class="w"> </span>l2ss-py<span class="w"> </span>/path/to/input.nc<span class="w"> </span>/path/to/output.nc<span class="w"> </span>--shapefile<span class="w"> </span>/path/to/test.shp
</pre></div>
</div>
<p>or</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>run<span class="w"> </span>l2ss-py<span class="w"> </span>/path/to/input.nc<span class="w"> </span>/path/to/output.nc<span class="w"> </span>--shapefile<span class="w"> </span>/path/to/test.geojson
</pre></div>
</div>
</section>
<section id="running-harmony-locally">
<h4>Running Harmony locally<a class="headerlink" href="#running-harmony-locally" title="Link to this heading"></a></h4>
<p>In order to fully test l2ss-py with Harmony, you can run Harmony locally. This requires the data exists in UAT Earthdata Cloud.</p>
<ol class="arabic">
<li><p>Set up local Harmony instance. Instructions <a class="reference external" href="https://github.com/nasa/harmony#Quick-Start">here</a></p></li>
<li><p>Add concept ID for your data to <a class="reference external" href="https://github.com/nasa/harmony/blob/main/config/services.yml">services.yml</a></p></li>
<li><p>Execute a local Harmony l2ss-py request. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>localhost:3000/YOUR_COLLECTION_ID/ogc-api-coverages/1.0.0/collections/all/coverage/rangeset?format=application%2Fx-netcdf4&amp;subset=lat(-10%3A10)&amp;subset=lon(-10%3A10)&amp;maxResults=2
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="nasa-eosdis-integration">
<h3>NASA EOSDIS Integration<a class="headerlink" href="#nasa-eosdis-integration" title="Link to this heading"></a></h3>
<p>Detailed instructions for integrating with EOSDIS can be found <a class="reference internal" href="#EOSDISIntegrations.md"><span class="xref myst">here</span></a>.</p>
</section>
</section>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="subset.html">Subset Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="subset.html#subset-py">subset.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.align_time_to_lon_dim"><code class="docutils literal notranslate"><span class="pre">align_time_to_lon_dim()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.apply_scale_offset"><code class="docutils literal notranslate"><span class="pre">apply_scale_offset()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.calculate_chunks"><code class="docutils literal notranslate"><span class="pre">calculate_chunks()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.compute_coordinate_variable_names"><code class="docutils literal notranslate"><span class="pre">compute_coordinate_variable_names()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.compute_utc_name"><code class="docutils literal notranslate"><span class="pre">compute_utc_name()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.convert_bbox"><code class="docutils literal notranslate"><span class="pre">convert_bbox()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.convert_bound"><code class="docutils literal notranslate"><span class="pre">convert_bound()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.convert_time_from_description"><code class="docutils literal notranslate"><span class="pre">convert_time_from_description()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.create_geospatial_bounding_box"><code class="docutils literal notranslate"><span class="pre">create_geospatial_bounding_box()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.create_geospatial_bounds"><code class="docutils literal notranslate"><span class="pre">create_geospatial_bounds()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.datetime_from_mjd"><code class="docutils literal notranslate"><span class="pre">datetime_from_mjd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.ensure_counter_clockwise"><code class="docutils literal notranslate"><span class="pre">ensure_counter_clockwise()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.extract_epoch"><code class="docutils literal notranslate"><span class="pre">extract_epoch()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.get_coordinate_variable_names"><code class="docutils literal notranslate"><span class="pre">get_coordinate_variable_names()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.get_east_west_lon"><code class="docutils literal notranslate"><span class="pre">get_east_west_lon()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.get_hdf_type"><code class="docutils literal notranslate"><span class="pre">get_hdf_type()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.get_path"><code class="docutils literal notranslate"><span class="pre">get_path()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.get_time_epoch_var"><code class="docutils literal notranslate"><span class="pre">get_time_epoch_var()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.get_variable_data"><code class="docutils literal notranslate"><span class="pre">get_variable_data()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.is_360"><code class="docutils literal notranslate"><span class="pre">is_360()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.is_time_mjd"><code class="docutils literal notranslate"><span class="pre">is_time_mjd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.new_build_temporal_cond"><code class="docutils literal notranslate"><span class="pre">new_build_temporal_cond()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.normalize_paths"><code class="docutils literal notranslate"><span class="pre">normalize_paths()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.open_as_nc_dataset"><code class="docutils literal notranslate"><span class="pre">open_as_nc_dataset()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.override_decode_cf_datetime"><code class="docutils literal notranslate"><span class="pre">override_decode_cf_datetime()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.remove_scale_offset"><code class="docutils literal notranslate"><span class="pre">remove_scale_offset()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.set_json_history"><code class="docutils literal notranslate"><span class="pre">set_json_history()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.set_version_history"><code class="docutils literal notranslate"><span class="pre">set_version_history()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.shoelace_area"><code class="docutils literal notranslate"><span class="pre">shoelace_area()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.subset"><code class="docutils literal notranslate"><span class="pre">subset()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.subset_with_bbox"><code class="docutils literal notranslate"><span class="pre">subset_with_bbox()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.subset_with_shapefile_multi"><code class="docutils literal notranslate"><span class="pre">subset_with_shapefile_multi()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.test_access_sst_dtime_values"><code class="docutils literal notranslate"><span class="pre">test_access_sst_dtime_values()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.translate_longitude"><code class="docutils literal notranslate"><span class="pre">translate_longitude()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.translate_timestamp"><code class="docutils literal notranslate"><span class="pre">translate_timestamp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset.html#podaac.subsetter.subset.update_netcdf_attrs"><code class="docutils literal notranslate"><span class="pre">update_netcdf_attrs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="subset_harmony.html">Subset Harmony Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="subset_harmony.html#subset-harmony-py">subset_harmony.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="subset_harmony.html#podaac.subsetter.subset_harmony.L2SSException"><code class="docutils literal notranslate"><span class="pre">L2SSException</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset_harmony.html#podaac.subsetter.subset_harmony.L2SubsetterService"><code class="docutils literal notranslate"><span class="pre">L2SubsetterService</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset_harmony.html#podaac.subsetter.subset_harmony.harmony_to_podaac_bbox"><code class="docutils literal notranslate"><span class="pre">harmony_to_podaac_bbox()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset_harmony.html#podaac.subsetter.subset_harmony.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="subset_harmony.html#podaac.subsetter.subset_harmony.podaac_to_harmony_bbox"><code class="docutils literal notranslate"><span class="pre">podaac_to_harmony_bbox()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="run_subsetter.html">Run Subsetter Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="run_subsetter.html#podaac.subsetter.run_subsetter.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="run_subsetter.html#podaac.subsetter.run_subsetter.parse_args"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="run_subsetter.html#podaac.subsetter.run_subsetter.run_subsetter"><code class="docutils literal notranslate"><span class="pre">run_subsetter()</span></code></a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="subset.html" class="btn btn-neutral float-right" title="Subset Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>